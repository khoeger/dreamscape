<!DOCTYPE html>

<!-- About A frame
https://aframe.io/docs/1.0.0/introduction/

Major reuse of code from https://glitch.com/~aframe-howler

Run: python3 -m http.server -->
<html>
  <head>
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <!--script src="https://unpkg.com/aframe-event-set-component@3.0.3/dist/aframe-event-set-component.min.js"></script-->
    <script src="/howler.js/dist/howler.js"></script>
    <script src="howler.js/dist/howler.spatial.min.js"></script>
    <script>
      var sound1 = new Howl({
        src: ['20200421_dream1.mp3'],
        //autoplay: true,
        loop: true,
        volume: 0.7,
      });
      var sound2 = new Howl({
        src: ['20200421_dream2.mp3'],
        //autoplay: true,
        loop: true,
        volume: 0.7,
      });
      var sound3 = new Howl({
        src: ['20200422_dream1.mp3'],
        //autoplay: true,
        loop: true,
        volume: 0.7,
      });
      var sound4 = new Howl({
        src: ['20200422_dream2.mp3'],
        //autoplay: true,
        loop: true,
        volume: 0.7,
      });
      var sound5 = new Howl({
        src: ['20200423_dream.mp3'],
        //autoplay: true,
        loop: true,
        volume: 0.7,
      });
      var sound6 = new Howl({
        src: ['20200424_dream.mp3'],
        //autoplay: true,
        loop: true,
        volume: 0.7,
      });
      var sound7 = new Howl({
        src: ['20200425_dream.mp3'],
        //autoplay: true,
        loop: true,
        volume: 0.7,
      });
    </script>
    <style type="text/css">
      #splash {
      position:absolute;
      height:100vh;
      width:100vw;
      overflow:hidden;
      color: white;
      background : rgba(0,0,0,0.6);
      top:0;
      left:0;
      text-align: center;
    }
    #vr {
        display: inline-block;
        border : 4px solid white;
        border-radius : 1rem;
        padding : 1rem;
        margin-top: 3rem;
        cursor: pointer;
    }
    </style>
  </head>
  <body>

    <a-scene>
      <a-assets>
        <!--img id="my-texture" src="webFriendlyMe2.jpg"-->
        <!--audio id="day1dream1" src="20200421_dream1.mp3" preload="auto"></audio-->
      </a-assets>

        <a-sphere
          id="dream1"
          position="0.5714285714 0 3.958973274"
          rotation="45 45 45"
          material="color: #4CC3D9 ; transparent: true ; opacity: 0.15"
        ></a-sphere>


        <a-sphere
          id="dream2"
          position="1.142857143 0 -3.83325939"
          rotation="45 45 45"
          material="color: #4CC3D9 ; transparent: true ; opacity: 0.15"
        ></a-sphere>


        <a-sphere
          id="dream3"
          position="-1.714285714 0 3.614031612"
          rotation="45 45 45"
          material="color: #4CC3D9 ; transparent: true ; opacity: 0.15"
        ></a-sphere>

        <a-sphere
          id="dream4"
          position="-2.285714286 0 -3.282607227"
          rotation="45 45 45"
          material="color: #4CC3D9 ; transparent: true ; opacity: 0.15"
        ></a-sphere>

        <a-sphere
          id="dream5"
          position="2.857142857 0 2.799416849"
          rotation="45 45 45"
          material="color: #4CC3D9 ; transparent: true ; opacity: 0.15"
        ></a-sphere>

        <a-sphere
          id="dream6"
          position="3.428571429 0 -2.060315015"
          rotation="45 45 45"
          material="color: #4CC3D9 ; transparent: true ; opacity: 0.15"
        ></a-sphere>

        <!-- skipped space in honor of forgotten dreams of night of 25 -->
        <a-sphere
          id="dream7"
          position="-4 0 0"
          rotation="45 45 45"
          material="color: #4CC3D9 ; transparent: true ; opacity: 0.15"
        ></a-sphere>

        <a-sphere
          position="3.428571429 0 -3.958973274"
          rotation="45 45 45"
          material="color: #4CC3D9 ; transparent: true ; opacity: 0.10"
        ></a-sphere>


      <a-sky color="#000000"></a-sky>
    </a-scene>

    <div id="splash">
      <p>Sounds will start after you click OK.</p>
      <p id="vr">OK</p>
    </div>

    <script type="text/javascript">

      var splash = document.querySelector('#splash');
      var vrButton = document.querySelector('#vr');

        var enter = function () {
          splash.parentNode.removeChild(splash);
        }
        vrButton.addEventListener('click', enter);

        var position_dream1 = document.getElementById("dream1").getAttribute('position');
        var position_dream2 = document.getElementById("dream2").getAttribute('position');
        var position_dream3 = document.getElementById("dream3").getAttribute('position');
        var position_dream4 = document.getElementById("dream4").getAttribute('position');
        var position_dream5 = document.getElementById("dream5").getAttribute('position');
        var position_dream6 = document.getElementById("dream6").getAttribute('position');
        var position_dream7 = document.getElementById("dream7").getAttribute('position');



        sound1.pos(Object.values(position_dream1)[0],
                  Object.values(position_dream1)[1],
                  Object.values(position_dream1)[2]
        );
        sound2.pos(Object.values(position_dream2)[0],
                  Object.values(position_dream2)[1],
                  Object.values(position_dream2)[2]
        );
        sound3.pos(Object.values(position_dream3)[0],
                  Object.values(position_dream3)[1],
                  Object.values(position_dream3)[2]
        );
        sound4.pos(Object.values(position_dream4)[0],
                  Object.values(position_dream4)[1],
                  Object.values(position_dream4)[2]
        );
        sound5.pos(Object.values(position_dream5)[0],
                  Object.values(position_dream5)[1],
                  Object.values(position_dream5)[2]
        );
        sound6.pos(Object.values(position_dream6)[0],
                  Object.values(position_dream6)[1],
                  Object.values(position_dream6)[2]
        );
        sound7.pos(Object.values(position_dream7)[0],
                  Object.values(position_dream7)[1],
                  Object.values(position_dream7)[2]
        );


        sound1.play();
        sound2.play();
        sound3.play();
        sound4.play();
        sound5.play();
        sound6.play();
        sound7.play();

        /*

        // --- Start accessing DOM elements
        var dreams = ['dream1'];

        dreams.forEach(
          function(dream){
            window[dream] = document.getElementById(dream);
          }
        );

        var Dream = function(options){
          var self = this;

          self.sounds = [];

          self._spriteMap = options.spriteMap;
          self._sprite = options.sprite;
          self.setupListeners();

          // audio sprite definition
          self.sound = new Howl({
            src: options.src,
            sprite: options.sprite
          });
          // Begin progress???
        }; */
       /*
        Sprite.prototype = {

          //set up listeners for each sprite's click area
          setupListeners: function() {
            var self = this;
            var keys = Object.keys( self._spriteMap);

            keys.forEach(function(key){
              window[key].addEventListener( 'click', function(){
                self.play(key);
              }, false);
            });
          },

          // play sprite when clicked, and track progress
          play: function(key) {
            var self = this;
            var sprite = self._spriteMap[key];

            // play sprite sound and capture it's id
            var id = self.sound.play(sprite);

            // create progress element and begin tracking it
            var elm = document.createElement('div');
            elm.className = 'progress';
            elm.id = id;
            elm.dataset.sprite = sprite;
            window[key].appendChild(elm);
            self.sounds.push(elm);

            // When sound is finished, remove progress element.
            self.sound.once('end', function(){
              var index = self.sounds.indexOf(elm);
              if (index >= 0){
                self.sounds.splice(index, 1);
                windows[key].removeChild(elm);
              }
            }, id);
          },

          // step within request animation frame updating playback position
          step: function(){
            var self = this;
            // example following has lots of comments here,
            // not sure if section necessary yet
          }
        };

        // Set up new sprite class & pass in options
        var sprite = new Sprite({
          src: ["20200421_dream1.mp3"];
          // not sure about this part
          sprite: {
            one: [0, 450],
          },
          spriteMap: {
            dream1: 'one',
          }
        }); */


      </script>

  </body>
</html>
